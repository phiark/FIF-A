<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>FIF-A Architecture ‚Äî Deep Neural Analysis</title>

        <!-- External Libraries -->
        <script src="https://d3js.org/d3.v7.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/lib/common.min.js"></script>
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
        />
        <script
            defer
            src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"
        ></script>
        <script
            defer
            src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
        ></script>

        <!-- Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=SF+Mono:wght@400;600&display=swap"
            rel="stylesheet"
        />

        <style>
            /* ==================== APPLE DESIGN SYSTEM ==================== */

            :root {
                /* Neural Color Palette - Inspired by Apple's Vision Pro */
                --neural-primary: #007aff; /* iOS Blue */
                --neural-secondary: #5e5ce6; /* Indigo */
                --neural-success: #34c759; /* Green */
                --neural-warning: #ff9500; /* Orange */
                --neural-danger: #ff3b30; /* Red */
                --neural-purple: #af52de; /* Purple */
                --neural-pink: #ff2d55; /* Pink */
                --neural-cyan: #64d2ff; /* Cyan */

                /* Surfaces - Glassmorphism */
                --surface-bg: #000000;
                --surface-elevated: rgba(30, 30, 30, 0.72);
                --surface-card: rgba(44, 44, 46, 0.68);
                --surface-hover: rgba(58, 58, 60, 0.82);
                --surface-overlay: rgba(0, 0, 0, 0.5);

                /* Borders & Dividers */
                --border-subtle: rgba(255, 255, 255, 0.06);
                --border-medium: rgba(255, 255, 255, 0.12);
                --border-strong: rgba(255, 255, 255, 0.18);

                /* Typography */
                --text-primary: rgba(255, 255, 255, 0.92);
                --text-secondary: rgba(255, 255, 255, 0.65);
                --text-tertiary: rgba(255, 255, 255, 0.45);

                /* Shadows - Apple-style depth */
                --shadow-sm:
                    0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
                --shadow-md:
                    0 4px 6px rgba(0, 0, 0, 0.1), 0 2px 4px rgba(0, 0, 0, 0.06);
                --shadow-lg:
                    0 10px 15px -3px rgba(0, 0, 0, 0.3),
                    0 4px 6px rgba(0, 0, 0, 0.2);
                --shadow-xl:
                    0 20px 25px -5px rgba(0, 0, 0, 0.4),
                    0 10px 10px rgba(0, 0, 0, 0.2);
                --shadow-glow: 0 0 20px rgba(0, 122, 255, 0.4);

                /* Spacing System (8px grid) */
                --space-xs: 4px;
                --space-sm: 8px;
                --space-md: 16px;
                --space-lg: 24px;
                --space-xl: 32px;
                --space-2xl: 48px;
                --space-3xl: 64px;

                /* Border Radius */
                --radius-sm: 8px;
                --radius-md: 12px;
                --radius-lg: 16px;
                --radius-xl: 20px;
                --radius-2xl: 28px;

                /* Transitions */
                --transition-fast: 0.15s cubic-bezier(0.4, 0, 0.2, 1);
                --transition-base: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                --transition-slow: 0.5s cubic-bezier(0.4, 0, 0.2, 1);
                --transition-spring: 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            }

            /* ==================== GLOBAL RESET & BASE ==================== */

            *,
            *::before,
            *::after {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            html {
                font-size: 16px;
                scroll-behavior: smooth;
            }

            body {
                font-family:
                    -apple-system, BlinkMacSystemFont, "Inter",
                    "SF Pro Display", "Segoe UI", system-ui, sans-serif;
                background: var(--surface-bg);
                color: var(--text-primary);
                line-height: 1.6;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
                overflow-x: hidden;
                position: relative;
            }

            /* Animated Background Gradient Mesh */
            body::before {
                content: "";
                position: fixed;
                top: -50%;
                left: -50%;
                width: 200%;
                height: 200%;
                background:
                    radial-gradient(
                        circle at 20% 30%,
                        rgba(0, 122, 255, 0.08) 0%,
                        transparent 50%
                    ),
                    radial-gradient(
                        circle at 80% 70%,
                        rgba(94, 92, 230, 0.08) 0%,
                        transparent 50%
                    ),
                    radial-gradient(
                        circle at 50% 50%,
                        rgba(175, 82, 222, 0.05) 0%,
                        transparent 70%
                    );
                animation: gradientShift 20s ease infinite;
                pointer-events: none;
                z-index: 0;
            }

            @keyframes gradientShift {
                0%,
                100% {
                    transform: translate(0, 0) rotate(0deg);
                }
                25% {
                    transform: translate(5%, 5%) rotate(90deg);
                }
                50% {
                    transform: translate(-5%, 5%) rotate(180deg);
                }
                75% {
                    transform: translate(-5%, -5%) rotate(270deg);
                }
            }

            /* ==================== SCROLLBAR STYLING ==================== */

            ::-webkit-scrollbar {
                width: 8px;
                height: 8px;
            }

            ::-webkit-scrollbar-track {
                background: transparent;
            }

            ::-webkit-scrollbar-thumb {
                background: rgba(255, 255, 255, 0.2);
                border-radius: 10px;
                transition: background var(--transition-base);
            }

            ::-webkit-scrollbar-thumb:hover {
                background: rgba(255, 255, 255, 0.3);
            }

            /* ==================== CONTAINER & LAYOUT ==================== */

            .container {
                max-width: 1400px;
                margin: 0 auto;
                padding: var(--space-xl) var(--space-lg);
                position: relative;
                z-index: 1;
            }

            /* ==================== HEADER - Hero Section ==================== */

            .hero {
                text-align: center;
                padding: var(--space-3xl) var(--space-lg) var(--space-2xl);
                margin-bottom: var(--space-2xl);
                position: relative;
            }

            .hero-icon {
                font-size: 4rem;
                margin-bottom: var(--space-md);
                display: inline-block;
                animation: float 3s ease-in-out infinite;
                filter: drop-shadow(0 4px 12px rgba(0, 122, 255, 0.4));
            }

            @keyframes float {
                0%,
                100% {
                    transform: translateY(0px);
                }
                50% {
                    transform: translateY(-10px);
                }
            }

            .hero-title {
                font-size: clamp(2.5rem, 5vw, 4rem);
                font-weight: 800;
                letter-spacing: -0.03em;
                margin-bottom: var(--space-sm);
                background: linear-gradient(135deg, #ffffff 0%, #a0a0a0 100%);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
                line-height: 1.1;
            }

            .hero-subtitle {
                font-size: clamp(1rem, 2vw, 1.25rem);
                color: var(--text-secondary);
                font-weight: 500;
                max-width: 700px;
                margin: 0 auto var(--space-lg);
                line-height: 1.5;
            }

            .hero-badge {
                display: inline-flex;
                align-items: center;
                gap: var(--space-sm);
                padding: var(--space-xs) var(--space-md);
                background: var(--surface-elevated);
                backdrop-filter: blur(20px) saturate(180%);
                -webkit-backdrop-filter: blur(20px) saturate(180%);
                border: 1px solid var(--border-medium);
                border-radius: 100px;
                font-family: "SF Mono", "JetBrains Mono", monospace;
                font-size: 0.8rem;
                color: var(--neural-cyan);
                font-weight: 600;
                box-shadow: var(--shadow-md);
            }

            .badge-dot {
                width: 6px;
                height: 6px;
                border-radius: 50%;
                background: var(--neural-success);
                animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
            }

            @keyframes pulse {
                0%,
                100% {
                    opacity: 1;
                }
                50% {
                    opacity: 0.5;
                }
            }

            /* ==================== GLASSMORPHIC CARD SYSTEM ==================== */

            .card {
                background: var(--surface-card);
                backdrop-filter: blur(40px) saturate(180%);
                -webkit-backdrop-filter: blur(40px) saturate(180%);
                border: 1px solid var(--border-subtle);
                border-radius: var(--radius-xl);
                padding: var(--space-xl);
                margin-bottom: var(--space-lg);
                box-shadow: var(--shadow-lg);
                transition: all var(--transition-base);
                position: relative;
                overflow: hidden;
            }

            .card::before {
                content: "";
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                height: 1px;
                background: linear-gradient(
                    90deg,
                    transparent,
                    rgba(255, 255, 255, 0.1),
                    transparent
                );
                opacity: 0;
                transition: opacity var(--transition-base);
            }

            .card:hover {
                transform: translateY(-2px);
                box-shadow: var(--shadow-xl);
                border-color: var(--border-medium);
            }

            .card:hover::before {
                opacity: 1;
            }

            /* ==================== SECTION HEADERS ==================== */

            .section-header {
                display: flex;
                align-items: center;
                justify-content: space-between;
                margin-bottom: var(--space-lg);
                padding-bottom: var(--space-md);
                border-bottom: 1px solid var(--border-subtle);
            }

            .section-title {
                font-size: 1.5rem;
                font-weight: 700;
                letter-spacing: -0.02em;
                display: flex;
                align-items: center;
                gap: var(--space-sm);
            }

            .section-title-icon {
                font-size: 1.75rem;
            }

            .section-meta {
                font-size: 0.85rem;
                color: var(--text-tertiary);
                font-weight: 500;
            }

            /* ==================== GRID LAYOUTS ==================== */

            .grid-2 {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
                gap: var(--space-lg);
                margin-bottom: var(--space-lg);
            }

            .grid-4 {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: var(--space-md);
            }

            @media (max-width: 768px) {
                .grid-2 {
                    grid-template-columns: 1fr;
                }
            }

            /* ==================== STATISTICS CARDS ==================== */

            .stat-card {
                background: linear-gradient(
                    145deg,
                    rgba(255, 255, 255, 0.03) 0%,
                    rgba(255, 255, 255, 0.01) 100%
                );
                border: 1px solid var(--border-subtle);
                border-radius: var(--radius-md);
                padding: var(--space-lg);
                text-align: center;
                transition: all var(--transition-base);
                position: relative;
                overflow: hidden;
            }

            .stat-card::after {
                content: "";
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                height: 2px;
                background: linear-gradient(
                    90deg,
                    var(--neural-primary),
                    var(--neural-secondary)
                );
                transform: scaleX(0);
                transition: transform var(--transition-base);
            }

            .stat-card:hover {
                background: linear-gradient(
                    145deg,
                    rgba(255, 255, 255, 0.05) 0%,
                    rgba(255, 255, 255, 0.02) 100%
                );
                border-color: var(--border-medium);
            }

            .stat-card:hover::after {
                transform: scaleX(1);
            }

            .stat-value {
                font-size: 2.5rem;
                font-weight: 800;
                font-family: "SF Mono", monospace;
                background: linear-gradient(
                    135deg,
                    var(--neural-cyan),
                    var(--neural-primary)
                );
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                margin-bottom: var(--space-xs);
                line-height: 1;
            }

            .stat-label {
                font-size: 0.75rem;
                color: var(--text-tertiary);
                text-transform: uppercase;
                letter-spacing: 0.1em;
                font-weight: 600;
            }

            /* ==================== D3 VISUALIZATION CONTAINER ==================== */

            .viz-container {
                width: 100%;
                height: 600px;
                background: radial-gradient(
                    circle at center,
                    rgba(0, 122, 255, 0.03) 0%,
                    rgba(0, 0, 0, 0.5) 100%
                );
                border-radius: var(--radius-lg);
                border: 1px solid var(--border-subtle);
                position: relative;
                overflow: hidden;
                box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.2);
            }

            #data-flow {
                width: 100%;
                height: 100%;
            }

            /* D3 Node Styles */
            .node {
                cursor: pointer;
                transition: all var(--transition-fast);
            }

            .node rect {
                fill: rgba(30, 30, 30, 0.8);
                stroke-width: 2px;
                rx: 10;
                ry: 10;
                transition: all var(--transition-base);
            }

            .node.input rect {
                stroke: var(--neural-success);
                fill: rgba(52, 199, 89, 0.08);
            }
            .node.embedding rect {
                stroke: var(--neural-primary);
                fill: rgba(0, 122, 255, 0.08);
            }
            .node.attention rect {
                stroke: var(--neural-warning);
                fill: rgba(255, 149, 0, 0.08);
            }
            .node.friction rect {
                stroke: var(--neural-purple);
                fill: rgba(175, 82, 222, 0.08);
            }
            .node.output rect {
                stroke: var(--neural-cyan);
                fill: rgba(100, 210, 255, 0.08);
            }

            .node:hover rect {
                stroke-width: 3px;
                filter: drop-shadow(0 0 12px currentColor);
            }

            .node text {
                fill: var(--text-primary);
                font-weight: 600;
                font-size: 12px;
                text-anchor: middle;
                pointer-events: none;
                font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            }

            .dimension-label {
                fill: var(--text-tertiary);
                font-size: 10px;
                font-family: "SF Mono", monospace;
            }

            .link {
                fill: none;
                stroke: rgba(255, 255, 255, 0.15);
                stroke-width: 2px;
                transition: all var(--transition-base);
            }

            .link:hover {
                stroke: var(--neural-primary);
                stroke-width: 3px;
                filter: drop-shadow(0 0 4px var(--neural-primary));
            }

            .energy-particle {
                fill: var(--neural-warning);
                filter: drop-shadow(0 0 6px var(--neural-warning));
            }

            /* ==================== LEGEND ==================== */

            .legend {
                display: flex;
                gap: var(--space-md);
                flex-wrap: wrap;
                justify-content: center;
                margin-top: var(--space-lg);
                padding-top: var(--space-lg);
                border-top: 1px solid var(--border-subtle);
            }

            .legend-item {
                display: flex;
                align-items: center;
                gap: var(--space-sm);
                font-size: 0.85rem;
                color: var(--text-secondary);
                font-weight: 500;
            }

            .legend-dot {
                width: 10px;
                height: 10px;
                border-radius: 50%;
                box-shadow: 0 0 8px currentColor;
            }

            /* ==================== FORMULA CARDS ==================== */

            .formula-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
                gap: var(--space-md);
            }

            .formula-card {
                background: rgba(0, 0, 0, 0.3);
                border-left: 3px solid var(--neural-primary);
                border-radius: 0 var(--radius-md) var(--radius-md) 0;
                padding: var(--space-lg);
                transition: all var(--transition-base);
            }

            .formula-card:hover {
                border-left-color: var(--neural-cyan);
                background: rgba(0, 0, 0, 0.4);
            }

            .formula-title {
                font-size: 0.75rem;
                color: var(--neural-primary);
                text-transform: uppercase;
                letter-spacing: 0.1em;
                font-weight: 700;
                margin-bottom: var(--space-md);
            }

            .formula-card .katex {
                font-size: 1.1rem;
            }

            /* ==================== DATA TABLE ==================== */

            .table-wrapper {
                overflow-x: auto;
                border-radius: var(--radius-md);
                border: 1px solid var(--border-subtle);
                background: rgba(0, 0, 0, 0.2);
            }

            table {
                width: 100%;
                border-collapse: collapse;
                font-size: 0.9rem;
            }

            th {
                background: rgba(255, 255, 255, 0.03);
                padding: var(--space-md) var(--space-lg);
                text-align: left;
                font-weight: 600;
                color: var(--text-secondary);
                border-bottom: 1px solid var(--border-subtle);
                font-size: 0.75rem;
                text-transform: uppercase;
                letter-spacing: 0.05em;
            }

            td {
                padding: var(--space-md) var(--space-lg);
                border-bottom: 1px solid var(--border-subtle);
                color: var(--text-primary);
            }

            tr:last-child td {
                border-bottom: none;
            }

            tr:hover td {
                background: rgba(255, 255, 255, 0.02);
            }

            /* Status Tags */
            .tag {
                display: inline-flex;
                align-items: center;
                padding: 4px 10px;
                border-radius: 6px;
                font-size: 0.7rem;
                font-weight: 700;
                text-transform: uppercase;
                letter-spacing: 0.05em;
            }

            .tag.critical {
                background: rgba(255, 59, 48, 0.15);
                color: var(--neural-danger);
                border: 1px solid rgba(255, 59, 48, 0.3);
            }

            .tag.improved {
                background: rgba(52, 199, 89, 0.15);
                color: var(--neural-success);
                border: 1px solid rgba(52, 199, 89, 0.3);
            }

            .tag.warning {
                background: rgba(255, 149, 0, 0.15);
                color: var(--neural-warning);
                border: 1px solid rgba(255, 149, 0, 0.3);
            }

            /* ==================== MODAL ==================== */

            .modal {
                position: fixed;
                inset: 0;
                background: rgba(0, 0, 0, 0.85);
                backdrop-filter: blur(20px);
                -webkit-backdrop-filter: blur(20px);
                display: none;
                align-items: center;
                justify-content: center;
                z-index: 1000;
                opacity: 0;
                transition: opacity var(--transition-base);
            }

            .modal.show {
                opacity: 1;
            }

            .modal-content {
                background: var(--surface-elevated);
                backdrop-filter: blur(40px) saturate(180%);
                -webkit-backdrop-filter: blur(40px) saturate(180%);
                max-width: 700px;
                width: 90%;
                border: 1px solid var(--border-medium);
                border-radius: var(--radius-2xl);
                padding: var(--space-2xl);
                box-shadow: var(--shadow-xl);
                transform: scale(0.95) translateY(20px);
                transition: transform var(--transition-spring);
            }

            .modal.show .modal-content {
                transform: scale(1) translateY(0);
            }

            .modal-header {
                display: flex;
                align-items: center;
                justify-content: space-between;
                margin-bottom: var(--space-lg);
                padding-bottom: var(--space-md);
                border-bottom: 1px solid var(--border-subtle);
            }

            .modal-title {
                font-size: 1.5rem;
                font-weight: 700;
                color: var(--neural-primary);
            }

            .close-btn {
                background: rgba(255, 255, 255, 0.1);
                border: none;
                width: 32px;
                height: 32px;
                border-radius: 50%;
                color: var(--text-secondary);
                font-size: 20px;
                cursor: pointer;
                transition: all var(--transition-fast);
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .close-btn:hover {
                background: rgba(255, 255, 255, 0.15);
                color: var(--text-primary);
            }

            .ref-item {
                background: rgba(0, 0, 0, 0.3);
                padding: var(--space-md);
                border-radius: var(--radius-sm);
                margin-bottom: var(--space-sm);
                display: flex;
                justify-content: space-between;
                align-items: center;
                border: 1px solid var(--border-subtle);
            }

            .copy-btn {
                background: var(--neural-primary);
                color: white;
                border: none;
                padding: 6px 12px;
                border-radius: 6px;
                cursor: pointer;
                font-size: 0.75rem;
                font-weight: 600;
                transition: all var(--transition-fast);
            }

            .copy-btn:hover {
                background: #0051d5;
                transform: scale(1.05);
            }

            /* ==================== MERMAID DIAGRAMS ==================== */

            .diagram-container {
                background: rgba(0, 0, 0, 0.2);
                border-radius: var(--radius-md);
                padding: var(--space-lg);
                overflow-x: auto;
            }

            .mermaid {
                display: flex;
                justify-content: center;
            }

            /* ==================== REPORT VIEWER ==================== */

            .report-layout {
                display: grid;
                grid-template-columns: 280px 1fr;
                gap: var(--space-lg);
                align-items: start;
            }

            .sidebar {
                background: var(--surface-card);
                backdrop-filter: blur(40px);
                -webkit-backdrop-filter: blur(40px);
                border: 1px solid var(--border-subtle);
                border-radius: var(--radius-lg);
                padding: var(--space-lg);
                position: sticky;
                top: var(--space-lg);
                max-height: calc(100vh - 100px);
                overflow-y: auto;
            }

            .search-box {
                width: 100%;
                background: rgba(0, 0, 0, 0.3);
                border: 1px solid var(--border-subtle);
                color: var(--text-primary);
                padding: 10px 14px;
                border-radius: var(--radius-sm);
                font-family: inherit;
                font-size: 0.9rem;
                margin-bottom: var(--space-md);
                transition: all var(--transition-base);
            }

            .search-box:focus {
                outline: none;
                border-color: var(--neural-primary);
                box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
            }

            .toc-link {
                display: block;
                padding: var(--space-sm) var(--space-md);
                color: var(--text-secondary);
                text-decoration: none;
                border-radius: var(--radius-sm);
                transition: all var(--transition-fast);
                font-size: 0.85rem;
                margin-bottom: 2px;
            }

            .toc-link:hover,
            .toc-link.active {
                background: rgba(0, 122, 255, 0.15);
                color: var(--neural-primary);
            }

            .markdown-body {
                color: var(--text-primary);
                line-height: 1.8;
            }

            .markdown-body h2 {
                color: var(--neural-primary);
                border-bottom: 1px solid var(--border-subtle);
                padding-bottom: var(--space-sm);
                margin-top: var(--space-2xl);
                margin-bottom: var(--space-lg);
            }

            .markdown-body h3 {
                color: var(--text-primary);
                margin-top: var(--space-xl);
                margin-bottom: var(--space-md);
            }

            .markdown-body p {
                margin-bottom: var(--space-md);
                color: var(--text-secondary);
            }

            .markdown-body code {
                background: rgba(0, 0, 0, 0.3);
                color: var(--neural-warning);
                padding: 2px 6px;
                border-radius: 4px;
                font-family: "SF Mono", monospace;
                font-size: 0.9em;
            }

            .markdown-body pre {
                background: rgba(0, 0, 0, 0.4);
                padding: var(--space-lg);
                border-radius: var(--radius-md);
                overflow-x: auto;
                border: 1px solid var(--border-subtle);
            }

            /* ==================== RESPONSIVE ==================== */

            @media (max-width: 1024px) {
                .report-layout {
                    grid-template-columns: 1fr;
                }
                .sidebar {
                    position: static;
                    max-height: 400px;
                }
            }

            @media (max-width: 640px) {
                .hero {
                    padding: var(--space-2xl) var(--space-md);
                }
                .hero-title {
                    font-size: 2rem;
                }
                .card {
                    padding: var(--space-lg);
                }
                .formula-grid {
                    grid-template-columns: 1fr;
                }
            }

            /* ==================== UTILITIES ==================== */

            .text-gradient {
                background: linear-gradient(
                    135deg,
                    var(--neural-cyan),
                    var(--neural-primary)
                );
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
            }

            .glow-text {
                text-shadow: 0 0 20px rgba(0, 122, 255, 0.5);
            }

            /* ==================== LOADING ANIMATION ==================== */

            @keyframes shimmer {
                0% {
                    background-position: -1000px 0;
                }
                100% {
                    background-position: 1000px 0;
                }
            }

            .loading {
                background: linear-gradient(
                    90deg,
                    rgba(255, 255, 255, 0.02) 0%,
                    rgba(255, 255, 255, 0.08) 50%,
                    rgba(255, 255, 255, 0.02) 100%
                );
                background-size: 1000px 100%;
                animation: shimmer 2s infinite;
            }
        </style>
    </head>
    <body>
        <!-- ==================== HERO SECTION ==================== -->
        <div class="hero">
            <div class="hero-icon">üß¨</div>
            <h1 class="hero-title">FIF-A Architecture</h1>
            <p class="hero-subtitle">
                Frictional Interaction Field ‚Äî Deep Neural Network Analysis &
                Performance Insights
            </p>
            <div class="hero-badge">
                <span class="badge-dot"></span>
                <span>Version 1.0.3</span>
                <span style="opacity: 0.5">‚Ä¢</span>
                <span>Generated: 2025-12-01</span>
            </div>
        </div>

        <!-- ==================== MAIN CONTAINER ==================== -->
        <div class="container">
            <!-- Neural Flow Visualization -->
            <div class="card">
                <div class="section-header">
                    <div class="section-title">
                        <span class="section-title-icon">üß†</span>
                        <span>Neural Architecture Flow</span>
                    </div>
                    <div class="section-meta">Interactive D3 Visualization</div>
                </div>

                <div class="viz-container">
                    <svg id="data-flow"></svg>
                </div>

                <div class="legend">
                    <div class="legend-item">
                        <div
                            class="legend-dot"
                            style="color: var(--neural-success)"
                        ></div>
                        <span>Input Layer</span>
                    </div>
                    <div class="legend-item">
                        <div
                            class="legend-dot"
                            style="color: var(--neural-primary)"
                        ></div>
                        <span>Embedding</span>
                    </div>
                    <div class="legend-item">
                        <div
                            class="legend-dot"
                            style="color: var(--neural-warning)"
                        ></div>
                        <span>Attention</span>
                    </div>
                    <div class="legend-item">
                        <div
                            class="legend-dot"
                            style="color: var(--neural-purple)"
                        ></div>
                        <span>Friction (Novel)</span>
                    </div>
                    <div class="legend-item">
                        <div
                            class="legend-dot"
                            style="color: var(--neural-cyan)"
                        ></div>
                        <span>Output</span>
                    </div>
                </div>
            </div>

            <!-- Stats + Diagram Grid -->
            <div class="grid-2">
                <div class="card">
                    <div class="section-header">
                        <div class="section-title">
                            <span class="section-title-icon">üìä</span>
                            <span>High-Level Pipeline</span>
                        </div>
                    </div>
                    <div class="diagram-container">
                        <pre class="mermaid">
graph LR
    A[Input] --> B(Embed)
    B --> C{Friction<br/>K=3}
    C -->|Iterate| C
    C --> D[Attention]
    D --> E[Classifier]
    C -.-> F((Energy))
    F --> G[Loss ŒªE]
                    </pre>
                    </div>
                </div>

                <div class="card">
                    <div class="section-header">
                        <div class="section-title">
                            <span class="section-title-icon">üìà</span>
                            <span>Project Statistics</span>
                        </div>
                    </div>
                    <div class="grid-4">
                        <div class="stat-card">
                            <div class="stat-value">5.2K</div>
                            <div class="stat-label">Lines of Code</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">0.80s</div>
                            <div class="stat-label">Avg Step Time</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">6318</div>
                            <div class="stat-label">Peak Energy</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">20+</div>
                            <div class="stat-label">Experiments</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mathematical Formulations -->
            <div class="card">
                <div class="section-header">
                    <div class="section-title">
                        <span class="section-title-icon">‚à´</span>
                        <span>Core Mathematical Formulations</span>
                    </div>
                </div>
                <div class="formula-grid">
                    <div class="formula-card">
                        <div class="formula-title">Energy Function</div>
                        $$ E = \frac{1}{2} \sum_{i,j} \mu_{ij} \|h_i - h_j\|^2
                        $$
                    </div>
                    <div class="formula-card">
                        <div class="formula-title">Friction Coefficient</div>
                        $$ \mu_{ij} = \text{softplus}(\text{MLP}(\cdot)) $$
                    </div>
                    <div class="formula-card">
                        <div class="formula-title">Equilibrium Update</div>
                        $$ H^{(t+1)} = H^t - \eta_t (\mathcal{L}_\mu H^t - q) $$
                    </div>
                    <div class="formula-card">
                        <div class="formula-title">Regularized Loss</div>
                        $$ \mathcal{L} = \mathcal{L}_{CE} + \lambda_E \log(1 +
                        E) $$
                    </div>
                </div>
            </div>

            <!-- Performance Table -->
            <div class="card">
                <div class="section-header">
                    <div class="section-title">
                        <span class="section-title-icon">üìâ</span>
                        <span>Performance Comparison (SNLI)</span>
                    </div>
                </div>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Metric</th>
                                <th>Baseline</th>
                                <th>Hybrid (FIF)</th>
                                <th>Delta</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Accuracy</td>
                                <td>0.7767</td>
                                <td>0.6971</td>
                                <td style="color: var(--neural-danger)">
                                    -8.0pt
                                </td>
                                <td>
                                    <span class="tag critical">Critical</span>
                                </td>
                            </tr>
                            <tr>
                                <td>ECE (Calibration)</td>
                                <td>0.0288</td>
                                <td>0.0192</td>
                                <td style="color: var(--neural-success)">
                                    -33%
                                </td>
                                <td>
                                    <span class="tag improved">Improved</span>
                                </td>
                            </tr>
                            <tr>
                                <td>Energy Mean</td>
                                <td>431.57</td>
                                <td>6318.40</td>
                                <td style="color: var(--neural-warning)">
                                    +15√ó
                                </td>
                                <td>
                                    <span class="tag warning">Explosion</span>
                                </td>
                            </tr>
                            <tr>
                                <td>Training Time</td>
                                <td>11 min</td>
                                <td>2.4 hrs</td>
                                <td style="color: var(--neural-danger)">
                                    +13√ó
                                </td>
                                <td>
                                    <span class="tag critical">Bottleneck</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- SST-2 Noise Table -->
            <div class="card">
                <div class="section-header">
                    <div class="section-title">
                        <span class="section-title-icon">üå™Ô∏è</span>
                        <span>Noisy SST-2 Robustness</span>
                    </div>
                    <div class="section-meta">
                        Mixed noise training (seed=42, Œª=1e-4 normalized)
                    </div>
                </div>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Noise</th>
                                <th>Baseline Acc</th>
                                <th>Hybrid Acc</th>
                                <th>Œî Accuracy</th>
                                <th>Œî ECE</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Low</td>
                                <td>0.8016</td>
                                <td>0.7867</td>
                                <td style="color: var(--neural-danger)">
                                    -1.5pt
                                </td>
                                <td style="color: var(--neural-success)">
                                    -0.016
                                </td>
                                <td>
                                    <span class="tag warning">Trade-off</span>
                                </td>
                            </tr>
                            <tr>
                                <td>Medium</td>
                                <td>0.7615</td>
                                <td>0.7890</td>
                                <td style="color: var(--neural-success)">
                                    +2.8pt
                                </td>
                                <td style="color: var(--neural-success)">
                                    -0.060
                                </td>
                                <td>
                                    <span class="tag improved">Robust</span>
                                </td>
                            </tr>
                            <tr>
                                <td>High</td>
                                <td>0.6995</td>
                                <td>0.7213</td>
                                <td style="color: var(--neural-success)">
                                    +2.2pt
                                </td>
                                <td style="color: var(--neural-success)">
                                    -0.064
                                </td>
                                <td>
                                    <span class="tag improved">Robust</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Energy Alerts -->
            <div class="card">
                <div class="section-header">
                    <div class="section-title">
                        <span class="section-title-icon">‚ö°</span>
                        <span>Energy Watch Alerts (v1.0.3)</span>
                    </div>
                    <div class="section-meta">
                        scope=last ‚Ä¢ mode=normalized ‚Ä¢ Œª=1e-4
                    </div>
                </div>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Split</th>
                                <th>Epoch</th>
                                <th>Energy Std</th>
                                <th>Energy p90</th>
                                <th>Reasons</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>SST-2 Low (val)</td>
                                <td>1</td>
                                <td>0.132</td>
                                <td>0.378</td>
                                <td>p90 &lt; 0.5</td>
                                <td>
                                    <span class="tag warning">Watch</span>
                                </td>
                            </tr>
                            <tr>
                                <td>SST-2 Med (val)</td>
                                <td>1</td>
                                <td>0.160</td>
                                <td>0.452</td>
                                <td>p90 &lt; 0.5</td>
                                <td>
                                    <span class="tag warning">Watch</span>
                                </td>
                            </tr>
                            <tr>
                                <td>SST-2 High (val)</td>
                                <td>-</td>
                                <td>‚Äî</td>
                                <td>‚Äî</td>
                                <td>No events recorded</td>
                                <td>
                                    <span class="tag improved">Stable</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Report Viewer -->
            <div class="card">
                <div class="section-header">
                    <div class="section-title">
                        <span class="section-title-icon">üìÑ</span>
                        <span>Phase Review Report</span>
                    </div>
                </div>
                <div class="report-layout">
                    <div class="sidebar">
                        <input
                            type="text"
                            id="report-search"
                            class="search-box"
                            placeholder="Search sections..."
                        />
                        <div id="report-toc"></div>
                    </div>
                    <div id="report-viewer" class="markdown-body">
                        <div
                            style="
                                padding: 40px;
                                text-align: center;
                                color: var(--text-tertiary);
                            "
                        >
                            <div
                                class="loading"
                                style="
                                    height: 20px;
                                    border-radius: 10px;
                                    margin-bottom: 16px;
                                "
                            ></div>
                            <div
                                class="loading"
                                style="
                                    height: 20px;
                                    width: 80%;
                                    margin: 0 auto;
                                    border-radius: 10px;
                                "
                            ></div>
                            <p style="margin-top: 24px; font-size: 0.9rem">
                                Loading report...
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal -->
        <div id="node-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title" id="modal-title">Node Details</div>
                    <button class="close-btn" id="modal-close">√ó</button>
                </div>
                <div id="modal-body"></div>
            </div>
        </div>

        <script>
            // ==================== MERMAID INITIALIZATION ====================
            mermaid.initialize({
                startOnLoad: true,
                theme: "dark",
                fontFamily: "-apple-system, BlinkMacSystemFont, sans-serif",
                themeVariables: {
                    primaryColor: "#007AFF",
                    primaryTextColor: "#fff",
                    primaryBorderColor: "#64D2FF",
                    lineColor: "#5E5CE6",
                    secondaryColor: "#AF52DE",
                    tertiaryColor: "#FF9500",
                },
            });

            const mathDelimiters = [
                { left: "$$", right: "$$", display: true },
                { left: "\\(", right: "\\)", display: false },
                { left: "$", right: "$", display: false },
            ];

            function renderMath(target = document.body) {
                if (typeof renderMathInElement === "undefined") {
                    return false;
                }
                renderMathInElement(target, { delimiters: mathDelimiters });
                return true;
            }

            if (!renderMath()) {
                window.addEventListener("load", () => renderMath());
            }

            // ==================== D3 VISUALIZATION ====================
            const container =
                document.getElementById("data-flow").parentElement;
            const width = container.clientWidth;
            const height = 600;

            const svg = d3
                .select("#data-flow")
                .attr("width", width)
                .attr("height", height)
                .attr("viewBox", "0 0 1400 600")
                .attr("preserveAspectRatio", "xMidYMid meet");

            // Glow filter
            const defs = svg.append("defs");
            const filter = defs.append("filter").attr("id", "glow");
            filter
                .append("feGaussianBlur")
                .attr("stdDeviation", "3")
                .attr("result", "coloredBlur");
            const feMerge = filter.append("feMerge");
            feMerge.append("feMergeNode").attr("in", "coloredBlur");
            feMerge.append("feMergeNode").attr("in", "SourceGraphic");

            const viz = svg.append("g");

            // Node data
            const nodes = [
                {
                    id: 0,
                    label: "Input\nTokens",
                    dim: "B√óL",
                    x: 100,
                    y: 100,
                    type: "input",
                    details: "Raw token IDs from tokenizer",
                },
                {
                    id: 1,
                    label: "Token\nEmbed",
                    dim: "B√óL√ó256",
                    x: 100,
                    y: 220,
                    type: "embedding",
                    details: "Learned embeddings (vocab=30522)",
                },
                {
                    id: 2,
                    label: "Position\nEmbed",
                    dim: "B√óL√ó256",
                    x: 300,
                    y: 220,
                    type: "embedding",
                    details: "Positional encodings",
                },
                {
                    id: 3,
                    label: "Noise\nCondition",
                    dim: "B√óL√ó256",
                    x: 500,
                    y: 220,
                    type: "embedding",
                    details: "Clean/Low/Med/High",
                },
                {
                    id: 4,
                    label: "Sum +\nDropout",
                    dim: "B√óL√ó256",
                    x: 300,
                    y: 350,
                    type: "embedding",
                    details: "Dropout p=0.1",
                },
                {
                    id: 5,
                    label: "Attention\nLayer 1",
                    dim: "B√óL√ó256",
                    x: 500,
                    y: 480,
                    type: "attention",
                    details: "4 heads, MHA+FFN",
                },
                {
                    id: 6,
                    label: "Friction\nLayer 1",
                    dim: "B√óL√ó256",
                    x: 800,
                    y: 480,
                    type: "friction",
                    details: "K=3, Dynamic Œº",
                },
                {
                    id: 7,
                    label: "Friction\nLayer 2",
                    dim: "B√óL√ó256",
                    x: 1100,
                    y: 480,
                    type: "friction",
                    details: "Second friction",
                },
                {
                    id: 8,
                    label: "Attention\nLayer 2",
                    dim: "B√óL√ó256",
                    x: 800,
                    y: 300,
                    type: "attention",
                    details: "Global context",
                },
                {
                    id: 9,
                    label: "Pooling",
                    dim: "B√ó256",
                    x: 1100,
                    y: 200,
                    type: "output",
                    details: "CLS or Mean",
                },
                {
                    id: 10,
                    label: "Classifier",
                    dim: "B√ó3",
                    x: 1100,
                    y: 100,
                    type: "output",
                    details: "Linear ‚Üí 3 classes",
                },
                {
                    id: 11,
                    label: "Energy Œ£",
                    dim: "Scalar",
                    x: 1300,
                    y: 350,
                    type: "friction",
                    details: "E‚ÇÅ + E‚ÇÇ",
                },
            ];

            const links = [
                { source: 0, target: 1 },
                { source: 1, target: 4 },
                { source: 2, target: 4 },
                { source: 3, target: 4 },
                { source: 4, target: 5 },
                { source: 5, target: 6 },
                { source: 6, target: 7 },
                { source: 7, target: 8 },
                { source: 8, target: 9 },
                { source: 9, target: 10 },
                { source: 6, target: 11, style: "dashed" },
                { source: 7, target: 11, style: "dashed" },
            ];

            // Draw links
            viz.selectAll(".link")
                .data(links)
                .enter()
                .append("path")
                .attr("class", "link")
                .attr("d", (d) => {
                    const s = nodes[d.source],
                        t = nodes[d.target];
                    return `M ${s.x + 60} ${s.y + 25} C ${s.x + 60} ${s.y + 80}, ${t.x + 60} ${t.y - 80}, ${t.x + 60} ${t.y}`;
                })
                .attr("stroke-dasharray", (d) =>
                    d.style === "dashed" ? "5,5" : "none",
                );

            // Draw nodes
            const nodeGroups = viz
                .selectAll(".node")
                .data(nodes)
                .enter()
                .append("g")
                .attr("class", (d) => `node ${d.type}`)
                .attr("transform", (d) => `translate(${d.x}, ${d.y})`);

            nodeGroups
                .append("rect")
                .attr("width", 120)
                .attr("height", 50)
                .style("filter", "url(#glow)");

            nodeGroups
                .append("text")
                .attr("x", 60)
                .attr("y", 20)
                .each(function (d) {
                    d.label.split("\n").forEach((line, i) => {
                        d3.select(this)
                            .append("tspan")
                            .attr("x", 60)
                            .attr("dy", i === 0 ? 0 : 14)
                            .text(line);
                    });
                });

            nodeGroups
                .append("text")
                .attr("class", "dimension-label")
                .attr("x", 60)
                .attr("y", 65)
                .text((d) => d.dim);

            // Energy particle animation
            const particle = viz
                .append("circle")
                .attr("r", 5)
                .attr("class", "energy-particle");

            function animateParticle() {
                const path = viz
                    .selectAll(".link")
                    .filter((d) => d.style === "dashed")
                    .nodes()[0];
                if (!path) return;

                const len = path.getTotalLength();
                particle
                    .attr("opacity", 0)
                    .transition()
                    .duration(100)
                    .attr("opacity", 1)
                    .transition()
                    .duration(2000)
                    .ease(d3.easeLinear)
                    .attrTween("transform", () => {
                        return (t) => {
                            const point = path.getPointAtLength(t * len);
                            return `translate(${point.x}, ${point.y})`;
                        };
                    })
                    .transition()
                    .duration(100)
                    .attr("opacity", 0)
                    .on("end", animateParticle);
            }
            animateParticle();

            // Modal interaction
            const modal = document.getElementById("node-modal");
            const modalTitle = document.getElementById("modal-title");
            const modalBody = document.getElementById("modal-body");

            nodeGroups.on("click", (e, d) => {
                modal.style.display = "flex";
                setTimeout(() => modal.classList.add("show"), 10);
                modalTitle.textContent = d.label.replace("\n", " ");
                modalBody.innerHTML = `
                <p style="font-size: 1.05rem; margin-bottom: 20px; color: var(--text-secondary);">${d.details}</p>
                <h4 style="color: var(--text-tertiary); margin-bottom: 12px; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.05em;">Code References</h4>
                <div class="ref-item">
                    <div style="font-family: 'SF Mono', monospace; font-size: 0.85rem;">
                        <div style="color: var(--neural-primary);">fif_mvp/models/${d.type}.py</div>
                        <div style="color: var(--text-tertiary); margin-top: 4px;">class ${d.type.charAt(0).toUpperCase() + d.type.slice(1)}Layer(nn.Module)</div>
                    </div>
                    <button class="copy-btn" onclick="navigator.clipboard.writeText('fif_mvp/models/${d.type}.py')">Copy</button>
                </div>
            `;
            });

            document.getElementById("modal-close").onclick = () => {
                modal.classList.remove("show");
                setTimeout(() => (modal.style.display = "none"), 300);
            };

            window.onclick = (e) => {
                if (e.target === modal) {
                    modal.classList.remove("show");
                    setTimeout(() => (modal.style.display = "none"), 300);
                }
            };

            // ==================== REPORT VIEWER ====================
            const viewer = document.getElementById("report-viewer");
            const toc = document.getElementById("report-toc");

            const fallbackMarkdown = `
## Executive Summary
The **FIF-A (Frictional Interaction Field)** hybrid architecture represents a novel approach integrating physics-inspired friction dynamics into transformer models.

### Current Status
- ‚úÖ Stable infrastructure with DDP support
- ‚ö†Ô∏è Energy-error correlation œÅ ‚âà 0.024 (target ‚â• 0.1)
- ‚ùå 8pt accuracy drop on SNLI vs baseline

## Architecture Innovation
The core hypothesis: **High Energy ‚áî High Uncertainty ‚áî High Error Probability**

\`\`\`python
def friction_update(H, mu, eta):
    laplacian = build_laplacian(mu)
    return H - eta * (laplacian @ H - q)
\`\`\`

## Performance Analysis
While the model shows **+2.7pt improvement on high-noise SST-2**, the 13√ó training slowdown and weak correlation require immediate attention.
        `;

            function renderContent(md) {
                viewer.innerHTML = marked.parse(md);
                renderMath(viewer);
                generateTOC();
            }

            function generateTOC() {
                toc.innerHTML = "";
                viewer.querySelectorAll("h2, h3").forEach((h, i) => {
                    h.id = `section-${i}`;
                    const link = document.createElement("a");
                    link.href = `#section-${i}`;
                    link.className = "toc-link";
                    link.textContent = h.textContent;
                    link.style.paddingLeft =
                        h.tagName === "H3" ? "24px" : "12px";
                    link.onclick = (e) => {
                        e.preventDefault();
                        h.scrollIntoView({
                            behavior: "smooth",
                            block: "start",
                        });
                        document
                            .querySelectorAll(".toc-link")
                            .forEach((l) => l.classList.remove("active"));
                        link.classList.add("active");
                    };
                    toc.appendChild(link);
                });
            }

            fetch("Phase_Review_Report.md")
                .then((r) => (r.ok ? r.text() : Promise.reject()))
                .then(renderContent)
                .catch(() => renderContent(fallbackMarkdown));

            document
                .getElementById("report-search")
                .addEventListener("input", (e) => {
                    const term = e.target.value.toLowerCase();
                    document.querySelectorAll(".toc-link").forEach((link) => {
                        link.style.display = link.textContent
                            .toLowerCase()
                            .includes(term)
                            ? "block"
                            : "none";
                    });
                });

            // Responsive resize
            window.addEventListener("resize", () => {
                const newWidth = container.clientWidth;
                svg.attr("width", newWidth);
            });
        </script>
    </body>
</html>
